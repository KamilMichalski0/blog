---
interface Props {
  title: string;
  date: Date;
  type: 'feat' | 'fix' | 'docs' | 'perf' | 'other';
  highlights: string[];
  version?: string;
}

const { title, date, type, highlights, version } = Astro.props;

const formattedDate = new Date(date).toLocaleDateString('pl-PL', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const typeConfig = {
  feat: {
    style: 'badge-success',
    label: 'Funkcja',
    icon: 'M12 4v16m8-8H4',
    color: 'border-green-500 dark:border-green-400',
    bgGradient: 'from-green-500/10 to-transparent',
  },
  fix: {
    style: 'badge-danger',
    label: 'Poprawka',
    icon: 'M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z',
    color: 'border-red-500 dark:border-red-400',
    bgGradient: 'from-red-500/10 to-transparent',
  },
  docs: {
    style: 'badge-primary',
    label: 'Dokumentacja',
    icon: 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z',
    color: 'border-blue-500 dark:border-blue-400',
    bgGradient: 'from-blue-500/10 to-transparent',
  },
  perf: {
    style: 'badge-warning',
    label: 'Wydajność',
    icon: 'M13 10V3L4 14h7v7l9-11h-7z',
    color: 'border-yellow-500 dark:border-yellow-400',
    bgGradient: 'from-yellow-500/10 to-transparent',
  },
  other: {
    style: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',
    label: 'Inne',
    icon: 'M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4',
    color: 'border-gray-400 dark:border-gray-600',
    bgGradient: 'from-gray-500/10 to-transparent',
  },
};

const config = typeConfig[type];
---

<div class={`relative pl-8 pb-8 border-l-4 ${config.color}`}>
  <!-- Timeline dot -->
  <div class="absolute -left-[13px] top-0 w-6 h-6 rounded-full bg-white dark:bg-gray-900 border-4 border-current flex items-center justify-center">
    <div class="w-2 h-2 rounded-full bg-current"></div>
  </div>

  <!-- Content card with gradient background -->
  <div class={`bg-white dark:bg-gray-800 bg-gradient-to-br ${config.bgGradient} dark:${config.bgGradient} rounded-xl p-6 hover:shadow-lg transition-shadow duration-300`}>
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4">
      <div class="flex items-center gap-3 flex-wrap">
        {version && (
          <span class="inline-flex items-center px-3 py-1 rounded-lg bg-indigo-100 dark:bg-indigo-900/50 text-indigo-800 dark:text-indigo-300 font-bold text-sm border border-indigo-200 dark:border-indigo-800">
            <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
            </svg>
            v{version}
          </span>
        )}
        <span class={`badge ${config.style} flex items-center gap-1.5`}>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={config.icon}></path>
          </svg>
          {config.label}
        </span>
      </div>
      <time class="flex items-center text-sm text-gray-500 dark:text-gray-400">
        <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
        </svg>
        {formattedDate}
      </time>
    </div>

    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">
      {title}
    </h3>

    {highlights.length > 0 && (
      <ul class="space-y-3">
        {highlights.map(highlight => (
          <li class="flex items-start group">
            <div class="flex-shrink-0 w-6 h-6 rounded-full bg-green-100 dark:bg-green-900/50 flex items-center justify-center mt-0.5 mr-3 group-hover:scale-110 transition-transform">
              <svg class="w-4 h-4 text-green-600 dark:text-green-400" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
              </svg>
            </div>
            <span class="text-gray-700 dark:text-gray-300 leading-relaxed flex-1">{highlight}</span>
          </li>
        ))}
      </ul>
    )}
  </div>
</div>