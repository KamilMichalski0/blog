---
title: 'Tworzenie Custom Plugins dla Claude Code - Kompletny Przewodnik'
description: 'Naucz siƒô budowaƒá w≈Çasne pluginy Claude Code z custom commands, agents, skills i hooks. Dystrybuuj je przez marketplace dla ca≈Çego zespo≈Çu.'
pubDate: 'Oct 24 2024'
heroImage: 'https://images.unsplash.com/photo-1495364141860-b0d03eccd065?w=1200&q=80'
tags: ['Claude Code', 'Plugins', 'Extensibility', 'Zaawansowane']
---

Claude Code pozwala rozszerzaƒá swoje mo≈ºliwo≈õci przez system plugin√≥w. W tym przewodniku nauczysz siƒô tworzyƒá w≈Çasne pluginy z custom slash commands, specialized agents, reusable skills i event hooks - wszystko oparte na oficjalnej dokumentacji technicznej.

## Struktura Pluginu

Ka≈ºdy plugin Claude Code ma okre≈õlonƒÖ strukturƒô katalog√≥w:

```
plugin-name/
‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îî‚îÄ‚îÄ plugin.json          # Metadata pluginu (wymagane)
‚îú‚îÄ‚îÄ commands/                 # Custom slash commands
‚îÇ   ‚îú‚îÄ‚îÄ command1.md
‚îÇ   ‚îî‚îÄ‚îÄ command2.md
‚îú‚îÄ‚îÄ agents/                   # Specialized agent definitions
‚îÇ   ‚îî‚îÄ‚îÄ agent-name.md
‚îú‚îÄ‚îÄ skills/                   # Reusable agent capabilities
‚îÇ   ‚îî‚îÄ‚îÄ skill-name/
‚îÇ       ‚îî‚îÄ‚îÄ SKILL.md
‚îú‚îÄ‚îÄ hooks/                    # Event handlers
‚îÇ   ‚îî‚îÄ‚îÄ hooks.json
‚îî‚îÄ‚îÄ .mcp.json                # MCP servers (opcjonalne)
```

## Plugin Manifest: `plugin.json`

Ka≈ºdy [plugin](https://docs.anthropic.com/en/docs/claude-code/plugins) **musi** zawieraƒá plik `.claude-plugin/plugin.json`:

```json
{
  "name": "plugin-name",
  "description": "Plugin description",
  "version": "1.0.0",
  "author": {
    "name": "Author Name"
  }
}
```

**Pola:**
- `name` - Unikalna nazwa pluginu (lowercase, hyphens)
- `description` - Kr√≥tki opis funkcjonalno≈õci
- `version` - Semantic versioning (1.0.0)
- `author` - Informacje o autorze

## Komponenty Pluginu

### 1. Custom Commands (Slash Commands)

Commands to pliki Markdown w katalogu `commands/` z YAML frontmatter.

**Przyk≈Çad: `commands/review.md`**

```markdown
---
name: review
description: Code review with security focus
---

Review the provided code for:
1. Security vulnerabilities (SQL injection, XSS, CSRF)
2. Performance issues
3. Best practices violations
4. Potential bugs

Format output as:
- üî¥ Critical issues
- üü° Warnings
- üü¢ Suggestions

Be specific and actionable.
```

**U≈ºycie:**
```bash
claude
> /review src/api/auth.js
```

**Przyk≈Çad 2: Command z parametrami**

`commands/generate-test.md`:

```markdown
---
name: generate-test
description: Generate unit tests for a file
---

Generate comprehensive unit tests for the specified file.

Include:
- Happy path scenarios
- Edge cases
- Error handling
- Mock external dependencies

Use the testing framework already present in the project.
```

**U≈ºycie:**
```
> /generate-test src/utils/validator.js
```

### 2. Agents (Specialized Agents)

Agents to wyspecjalizowani asystenci dla konkretnych zada≈Ñ, definiowani w katalogu `agents/`.

**Przyk≈Çad: `agents/security-reviewer.md`**

```markdown
---
name: security-reviewer
description: Security-focused code reviewer
---

You are a security expert reviewing code for vulnerabilities.

Focus areas:
1. **Input validation** - Check for injection attacks
2. **Authentication** - Verify proper auth implementation
3. **Authorization** - Ensure correct permission checks
4. **Data exposure** - Look for sensitive data leaks
5. **Cryptography** - Validate crypto usage

For each issue found:
- Severity: Critical/High/Medium/Low
- Location: File and line number
- Description: What the vulnerability is
- Fix: How to remediate

Prioritize critical and high severity issues.
```

**U≈ºycie w Claude Code:**

Claude automatycznie wykryje agenta. U≈ºytkownik mo≈ºe go wywo≈Çaƒá przez:
```
> Use security-reviewer agent to analyze src/api/
```

Lub Claude mo≈ºe autonomicznie wybraƒá tego agenta, gdy wykryje zadanie zwiƒÖzane z security.

### 3. Skills (Reusable Capabilities)

Skills to autonomiczne mo≈ºliwo≈õci, kt√≥re Claude mo≈ºe samodzielnie wywo≈Çywaƒá na podstawie kontekstu zadania.

**Struktura:**
```
skills/
‚îî‚îÄ‚îÄ database-query/
    ‚îî‚îÄ‚îÄ SKILL.md
```

**Przyk≈Çad: `skills/database-query/SKILL.md`**

```markdown
---
name: database-query
description: Execute SQL queries and analyze database schema
---

This skill enables querying databases and understanding schema.

## Capabilities

1. **Execute SELECT queries** - Run read-only SQL
2. **Analyze schema** - Inspect tables, columns, indexes
3. **Explain query plans** - Understand performance
4. **Suggest optimizations** - Improve query efficiency

## Usage

Claude will automatically use this skill when:
- User asks about database contents
- Needs to verify data before code changes
- Analyzing database performance
- Planning schema migrations

## Safety

- Only read operations allowed
- No DROP, DELETE, UPDATE, INSERT
- Queries timeout after 30 seconds
- Results limited to 1000 rows
```

**Jak dzia≈Ça:**

Skills sƒÖ **autonomicznie wywo≈Çywane przez Claude** - nie musisz ich rƒôcznie aktywowaƒá. Claude rozpozna kontekst i u≈ºyje odpowiedniego skilla.

**Przyk≈Çad automatycznego u≈ºycia:**
```
User: Sprawd≈∫, czy w tabeli users sƒÖ duplikaty emaili

Claude: [Automatycznie u≈ºywa database-query skill]
       Executing: SELECT email, COUNT(*) FROM users GROUP BY email HAVING COUNT(*) > 1

       Znalaz≈Çem 3 duplikaty emaili...
```

### 4. Hooks (Event Handlers)

Hooks automatyzujƒÖ dzia≈Çania na podstawie zdarze≈Ñ w Claude Code.

**Plik: `hooks/hooks.json`**

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "npx prettier --write \"$TOOL_INPUT_file_path\"",
            "timeout": 30
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "echo 'Executing: $TOOL_INPUT_command' >> .claude/audit.log",
            "timeout": 5
          }
        ]
      }
    ]
  }
}
```

**Obs≈Çugiwane eventy:**
- `PreToolUse` - Przed wykonaniem tool
- `PostToolUse` - Po wykonaniu tool
- `UserPromptSubmit` - Po wys≈Çaniu promptu przez u≈ºytkownika
- `SessionStart` - Na poczƒÖtku sesji
- `SessionEnd` - Na ko≈Ñcu sesji
- `Notification` - Przy notyfikacjach
- `Stop` - Gdy g≈Ç√≥wny agent ko≈Ñczy
- `SubagentStop` - Gdy subagent ko≈Ñczy

**Zmienne dostƒôpne w hookach:**
- `$TOOL_NAME` - Nazwa u≈ºytego toolu
- `$TOOL_INPUT_<param>` - Parametry toolu (np. `$TOOL_INPUT_file_path`)
- `$CLAUDE_PROJECT_DIR` - Katalog projektu

### 5. MCP Integration

Pluginy mogƒÖ zawieraƒá w≈Çasne [MCP serwery](https://docs.anthropic.com/en/docs/claude-code/mcp) przez `.mcp.json`.

**Przyk≈Çad: `.mcp.json`**

```json
{
  "mcpServers": {
    "company-api": {
      "transport": "http",
      "url": "https://internal.company.com/mcp",
      "env": {
        "API_TOKEN": "${COMPANY_API_TOKEN}"
      }
    },
    "local-db": {
      "transport": "stdio",
      "command": "npx",
      "args": ["-y", "postgres-mcp-server"],
      "env": {
        "DATABASE_URL": "${DATABASE_URL}"
      }
    }
  }
}
```

Po zainstalowaniu pluginu, MCP serwery bƒôdƒÖ automatycznie dostƒôpne.

## Tworzenie Kompletnego Pluginu - Przyk≈Çad

Stw√≥rzmy plugin `code-quality` do analizy jako≈õci kodu.

### Krok 1: Struktura

```bash
mkdir -p code-quality/.claude-plugin
mkdir -p code-quality/commands
mkdir -p code-quality/agents
mkdir -p code-quality/skills/complexity-analyzer
mkdir -p code-quality/hooks
```

### Krok 2: Manifest

**`code-quality/.claude-plugin/plugin.json`:**

```json
{
  "name": "code-quality",
  "description": "Comprehensive code quality analysis and improvements",
  "version": "1.0.0",
  "author": {
    "name": "Your Team"
  }
}
```

### Krok 3: Commands

**`code-quality/commands/analyze.md`:**

```markdown
---
name: analyze
description: Analyze code quality metrics
---

Analyze the specified file or directory for:

1. **Complexity** - Cyclomatic complexity score
2. **Duplication** - Repeated code blocks
3. **Test coverage** - Missing tests
4. **Dependencies** - Outdated or unused packages
5. **Security** - Known vulnerabilities

Provide:
- Overall quality score (0-100)
- Detailed breakdown per category
- Top 5 improvement recommendations
```

**`code-quality/commands/fix-quality.md`:**

```markdown
---
name: fix-quality
description: Automatically fix common code quality issues
---

Fix the following in the codebase:

1. Linting errors (ESLint/Prettier)
2. Unused imports
3. Console.log statements (remove or replace with logger)
4. Magic numbers (extract to constants)
5. Long functions (suggest refactoring)

Make changes incrementally and run tests after each change.
Only proceed if tests pass.
```

### Krok 4: Agent

**`code-quality/agents/refactoring-expert.md`:**

```markdown
---
name: refactoring-expert
description: Expert in code refactoring and design patterns
---

You are a refactoring expert specializing in clean code principles.

## Approach

1. **Analyze** - Understand current code structure
2. **Identify** - Find code smells and anti-patterns
3. **Plan** - Create step-by-step refactoring plan
4. **Execute** - Make incremental, testable changes
5. **Verify** - Ensure tests pass after each step

## Focus Areas

- Extract long methods into smaller functions
- Apply SOLID principles
- Introduce design patterns where beneficial
- Improve naming and readability
- Reduce coupling, increase cohesion

## Safety First

- Never break existing functionality
- Maintain test coverage
- Make atomic commits
- Document breaking changes
```

### Krok 5: Skill

**`code-quality/skills/complexity-analyzer/SKILL.md`:**

```markdown
---
name: complexity-analyzer
description: Automatically analyze code complexity
---

This skill calculates cyclomatic complexity and suggests refactoring.

## When to Use

Claude automatically uses this when:
- Reviewing pull requests
- Analyzing file complexity
- Planning refactoring
- Identifying technical debt

## Analysis

For each function:
1. Calculate cyclomatic complexity
2. Count lines of code
3. Identify nested loops/conditions
4. Suggest refactoring if complexity > 10

## Output Format

```
Function: calculateTotal()
Complexity: 15 (High)
Lines: 85
Recommendation: Extract validation logic to separate function
```
```

### Krok 6: Hooks

**`code-quality/hooks/hooks.json`:**

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "npx eslint --fix \"$TOOL_INPUT_file_path\" 2>/dev/null || true",
            "timeout": 30
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "echo 'Code Quality Plugin Active ‚úì' && npm run lint -- --quiet || echo '‚ö†Ô∏è  Linting issues detected'",
            "timeout": 60
          }
        ]
      }
    ]
  }
}
```

## Dystrybucja Plugin√≥w - Marketplace

### Tworzenie Marketplace

**Plik: `marketplace.json`**

```json
{
  "name": "team-plugins",
  "owner": {
    "name": "Your Company"
  },
  "description": "Internal company plugins",
  "plugins": [
    {
      "name": "code-quality",
      "source": "./code-quality",
      "description": "Code quality analysis and improvements"
    },
    {
      "name": "security-tools",
      "source": "./security-tools",
      "description": "Security scanning and remediation"
    }
  ]
}
```

### Struktura Repository

```
team-plugins-repo/
‚îú‚îÄ‚îÄ marketplace.json
‚îú‚îÄ‚îÄ code-quality/
‚îÇ   ‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ plugin.json
‚îÇ   ‚îú‚îÄ‚îÄ commands/
‚îÇ   ‚îú‚îÄ‚îÄ agents/
‚îÇ   ‚îî‚îÄ‚îÄ skills/
‚îî‚îÄ‚îÄ security-tools/
    ‚îú‚îÄ‚îÄ .claude-plugin/
    ‚îÇ   ‚îî‚îÄ‚îÄ plugin.json
    ‚îî‚îÄ‚îÄ ...
```

### Publikacja (Git Repository)

```bash
git init
git add .
git commit -m "Initial plugin marketplace"
git remote add origin https://github.com/company/team-plugins
git push -u origin main
```

## Instalacja Plugin√≥w

### Metoda 1: Interaktywna

```bash
claude
> /plugin
```

Wybierz "Install from marketplace" ‚Üí podaj URL ‚Üí wybierz plugin.

### Metoda 2: Command Line

```bash
claude
> /plugin install code-quality@team-plugins
```

Gdzie:
- `code-quality` - nazwa pluginu
- `team-plugins` - nazwa marketplace

### Metoda 3: Automatyczna (Team-wide)

**`.claude/settings.json` w repozytorium:**

```json
{
  "plugins": {
    "marketplaces": [
      {
        "name": "team-plugins",
        "url": "https://github.com/company/team-plugins"
      }
    ],
    "autoInstall": [
      "code-quality@team-plugins",
      "security-tools@team-plugins"
    ]
  }
}
```

Zesp√≥≈Ç automatycznie otrzyma pluginy po `git pull`.

## Testowanie Plugin√≥w Lokalnie

### Przed publikacjƒÖ, testuj lokalnie:

```bash
# 1. Przejd≈∫ do katalogu projektu
cd ~/my-project

# 2. Utw√≥rz local plugin directory
mkdir -p .claude/plugins

# 3. Skopiuj plugin
cp -r ~/code-quality .claude/plugins/

# 4. Uruchom Claude
claude

# 5. Testuj commands
> /analyze src/

# 6. Weryfikuj hooks
> Edit jaki≈õ plik i sprawd≈∫ czy auto-lint dzia≈Ça
```

## Best Practices

### 1. Dokumentuj Commands

Commands powinny byƒá **self-explanatory**:

‚úÖ Dobrze:
```markdown
---
name: deploy
description: Deploy application to staging or production
---

Deploy the application to specified environment.

Usage:
/deploy staging - Deploy to staging
/deploy production - Deploy to production (requires approval)

Prerequisites:
- Tests must pass
- No uncommitted changes
- CI/CD pipeline successful
```

‚ùå ≈πle:
```markdown
---
name: deploy
description: Deploy
---

Deploy app.
```

### 2. Agents z Jasnym Scope

Agent powinien mieƒá **okre≈õlonƒÖ specjalizacjƒô**:

‚úÖ Dobrze:
```markdown
---
name: api-designer
description: RESTful API design expert
---

Specialized in designing REST APIs following best practices...
```

‚ùå ≈πle:
```markdown
---
name: helper
description: Helps with code
---

I help with coding tasks...
```

### 3. Skills z Clear Triggers

Opisz **kiedy skill powinien byƒá u≈ºyty**:

```markdown
## When to Use

Claude automatically uses this skill when:
- User mentions "database" or "SQL"
- Needs to verify data before changes
- Planning schema migrations
```

### 4. Bezpieczne Hooks

**Waliduj input w hookach:**

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "if echo \"$TOOL_INPUT_command\" | grep -q 'rm -rf /'; then echo 'Dangerous command blocked' && exit 2; fi",
            "timeout": 5
          }
        ]
      }
    ]
  }
}
```

### 5. Versioning

U≈ºywaj **semantic versioning**:

- `1.0.0` - Initial release
- `1.0.1` - Bug fix (backward compatible)
- `1.1.0` - New feature (backward compatible)
- `2.0.0` - Breaking change

## Zaawansowane: Plugin z MCP + Hooks + Skills

**Kompletny przyk≈Çad - Database Tools Plugin:**

```
database-tools/
‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îî‚îÄ‚îÄ plugin.json
‚îú‚îÄ‚îÄ .mcp.json                 # PostgreSQL MCP server
‚îú‚îÄ‚îÄ commands/
‚îÇ   ‚îú‚îÄ‚îÄ query.md             # /query - Execute SQL
‚îÇ   ‚îî‚îÄ‚îÄ migrate.md           # /migrate - Run migrations
‚îú‚îÄ‚îÄ skills/
‚îÇ   ‚îî‚îÄ‚îÄ schema-analyzer/
‚îÇ       ‚îî‚îÄ‚îÄ SKILL.md         # Auto schema analysis
‚îî‚îÄ‚îÄ hooks/
    ‚îî‚îÄ‚îÄ hooks.json           # Log all queries
```

**`.mcp.json`:**
```json
{
  "mcpServers": {
    "postgres": {
      "transport": "stdio",
      "command": "npx",
      "args": ["-y", "postgres-mcp-server"],
      "env": {
        "DATABASE_URL": "${DATABASE_URL}"
      }
    }
  }
}
```

**`hooks/hooks.json`:**
```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "mcp__postgres__*",
        "hooks": [
          {
            "type": "command",
            "command": "echo \"[$(date)] Query: $TOOL_INPUT_query\" >> .claude/db-queries.log",
            "timeout": 5
          }
        ]
      }
    ]
  }
}
```

## üìö Dokumentacja i Zasoby

### Oficjalna Dokumentacja
- [Claude Code - Plugins](https://docs.anthropic.com/en/docs/claude-code/plugins)
- [Claude Code - MCP](https://docs.anthropic.com/en/docs/claude-code/mcp)
- [Model Context Protocol](https://modelcontextprotocol.io/)

### PowiƒÖzane Artyku≈Çy
- [MCP (Model Context Protocol)](/blog/mcp-model-context-protocol)
- [Hooks i Event-Driven Automation](/blog/hooks-event-automation)
- [Zaawansowane Techniki Claude Code](/blog/zaawansowane-techniki-claude-code)

## Podsumowanie

Custom Plugins w Claude Code pozwalajƒÖ:

‚úÖ Tworzyƒá **custom slash commands** dla team workflow
‚úÖ Definiowaƒá **specialized agents** dla konkretnych zada≈Ñ
‚úÖ Budowaƒá **reusable skills** autonomicznie u≈ºywane przez Claude
‚úÖ Automatyzowaƒá przez **event hooks**
‚úÖ Integrowaƒá **MCP serwery** dla zewnƒôtrznych narzƒôdzi
‚úÖ Dystrybuowaƒá przez **marketplace** dla ca≈Çego zespo≈Çu

### Nastƒôpne Kroki

1. Stw√≥rz pierwszy prosty plugin z jednym commandem
2. Przetestuj lokalnie w `.claude/plugins/`
3. Dodaj hooks dla automatyzacji
4. Stw√≥rz marketplace dla zespo≈Çu
5. Skonfiguruj auto-install w `.claude/settings.json`

Pluginy przekszta≈ÇcajƒÖ Claude Code w **w pe≈Çni konfigurowalnƒÖ platformƒô** dopasowanƒÖ do Twojego workflow! üîå
